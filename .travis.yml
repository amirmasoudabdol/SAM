language: cpp

dist: xenial
sudo: required
osx_image: xcode11.2
cache: ccache

# Travis CI VM OSs -> 2 OSs
os:
  - linux
  - osx

# Travis CI build matrix components -> 2 compilers
compiler:
  - gcc
  - clang

# Travis CI environmental variables -> 2 env variables
env:
  - TRAVIS_BUILD_TYPE=Debug
  - TRAVIS_BUILD_TYPE=Release

# Total builds: 8 = 2 [OSs] * 2 [comps] * 2 [env vars]

# You can install packages and sources for Linux using the APT addon, without
# running `apt-get` commands in your `before_install` script. You can also
# install macOS packages that are not included in the default OS X environment
# using Homebrew addon.
# See: https://docs.travis-ci.com/user/installing-dependencies/#installing-packages-with-the-apt-addon
# See: https://docs.travis-ci.com/user/installing-dependencies/#installing-packages-on-os-x
addons:
  homebrew:
    taps: nlohmann/json
    packages:
      - boost
      - nlohmann_json
      - armadillo
    update: true

before_install:

  # Configuring Linux Env
  - sudo apt-get -q update
  - sudo apt-get -y install libopenblas-dev
  - sudo apt-get -y install liblapack-dev
  - sudo apt-get -y install libarpack2-dev
  - sudo apt-get -y install libsuperlu-dev
  - sudo apt-get -y install libboost-all-dev
  - sudo apt-get -y install libarmadillo-dev

  # Configure ccache and use it also under Linux with clang and clang++
  - if [ "$TRAVIS_OS_NAME" == "osx" ]; then export PATH="/usr/local/bin:$PATH"; fi

  # Print some more system information after installing all build tools
  - echo "-------------------- BEGIN SYSTEM INFORMATION --------------------"
  - uname -a
  - if [ "$TRAVIS_OS_NAME" == "linux" ]; then lsb_release -a;                     fi
  - if [ "$TRAVIS_OS_NAME" == "osx" ];   then system_profiler SPSoftwareDataType; fi
  - env
  - which cmake
  - cmake --version
  - which $CC
  - $CC --version
  - which $CXX
  - $CXX --version
  - which ccache
  - ccache --version
  - ccache -s
  - echo "--------------------  END SYSTEM INFORMATION  --------------------"

before_script:
  # Run CMake
  - mkdir build
  - cd build
  - cmake -DCMAKE_BUILD_TYPE=${TRAVIS_BUILD_TYPE} ..
  # - cmake -DBUILD_TESTING:BOOL=ON -DCMAKE_BUILD_TYPE=${TRAVIS_BUILD_TYPE} ..

script:
  - cmake --build .
  # - make test